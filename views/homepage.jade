extends ./layout
block body
  .container
    include navbar
  .jumbotron
    .container
      .row
        br
        .col-sm-7
          br
          br

          h1.bigBrand Crowd source 
            br
            o everything, easily.
          h2.bigBrand Transform your data-analysis needs into a simple, enjoyable activity 
            o and reward users with discounts, money, or anything.
          
          //- a.btn.btn-default.btn-lg Sign up 
          br
        .col-sm-4.col-md-offset-1
          br
          br
          include login
    br
    br


  .container
    h1 Activity prototypes
    hr
    p.lead We provide templates so you can just plug in your data. 
      o Most data analysis needs that are crowd-sourcable fall under one of these basic functional paradigms. 
      o Want special features or total customization? 
      o You can upgrade your account to  
      a(href="")  Data Scientist 
      o and get a research team to design a solution specific for you.


    h4 Select a template to demo the use case:
    br
    #activityThumbs




  .container
    hr
    .tab-content

      #featurerecognition.tab-pane
        include usecases/featurerecognition

      #featuredetection.tab-pane
        include usecases/featuredetection

      #changedetection.tab-pane
        include usecases/changedetection

      #captchasolving.tab-pane
        include usecases/captchasolving

      #videotimetagging.tab-pane
        include usecases/captchasolving

      #impressionmeasuring.tab-pane
        include usecases/captchasolving


  script.

    // make new instance of Model
    var activityModel = new $.eventModel();


    // ***** table everything


    // Listen for when things of this model type are created
    activityModel.on('created', function(info,activity) {
      $("#activityTable").append($("<tr/>", {id:activity.id}))
      $.map(activity.data, function(val, attr){
        $("#"+activity.id).append($("<td/>",{id:attr,text:val}))
      })
    });

    // Listen for when things of this model type are updated
    activityModel.on('updated', function(info,activity) {
      var gid = activity.id
      $.map(activity.data, function(val, attr){
        if($("#"+activity.id+" #"+attr).text())
          $("#"+activity.id+" #"+attr).text(val)
        else
          $("#"+activity.id).append($("<td />",{id:attr,text:val}))
      })
    });


    // ***** thumbnails 


    // Listen for when things of this model type are created
    activityModel.on('created', function(info,activity) {
      var nm = activity.data.name.replace(/ /g,'').toLowerCase();

      $("#activityThumbs").append($("<div>", {class:"col-md-3 "}).append($("<div>",{
        class:"panel panel-default panel-body activityPrototype", 
        id:activity.id,
        "data-toggle":'tab',
        href:"#"+nm, 

      })))

      $("#activityThumbs "+ "#"+activity.id)
        .append($("<h4>",{
          id:'name',
          text:activity.data.name
      }))

      $("#activityThumbs "+ "#"+activity.id)
        .append($("<p>",{
          class:'desc',
          class:"borderBottom", 
          id:'name',
          text:activity.data.desc
      }))
    });


    // Listen for when things of this model type are updated
    activityModel.on('updated', function(info,activity) {
      $.map(activity.data, function(val, attr){
        if($("#"+activity.id+" #"+attr).text())
          $("#"+activity.id+" #"+attr).text(val)
        else $("#"+activity.id).append($("<div>",{id:attr,text:val}))
      })
    });


    // bind dom to model with sockets
    function dom_glue(model){
      io.socket.on( model, function(activity){
          activityModel.emit(activity.verb, activity);
      })
      io.socket.get( "/"+model, {}, function(activities){
        $.map(activities, function(activity){
          activityModel.emit('created', {
            id:activity.id,
            data:activity
          })
        })
      })
    }

    // When document is ready, grab latest things.
    $(document).ready(function(){

      dom_glue("activity");

      //- activityModel.emit('created', {
      //-   id:5415,
      //-   data:{name:"Feature Detection"}
      //- })

    });



